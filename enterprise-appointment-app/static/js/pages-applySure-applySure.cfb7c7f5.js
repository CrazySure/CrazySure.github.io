(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-applySure-applySure"],{"3dfa":function(e,t,a){var n=a("24fb"),r=a("1de5"),i=a("6e27");t=n(!1);var o=r(i);t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.apply-sure-container .main-container[data-v-6ea52adc]{padding-bottom:80px}.apply-sure-container .apply-key[data-v-6ea52adc]{padding-left:10px}.apply-sure-container .my-check-box[data-v-6ea52adc]{position:absolute;left:6px;top:7px}.apply-sure-container[data-v-6ea52adc]  .uni-card .uni-card__header{padding-left:20px;font-weight:700}.apply-sure-container .card-list[data-v-6ea52adc]{color:#3a3a3a}.apply-sure-container[data-v-6ea52adc]  uni-checkbox .uni-checkbox-input-checked{color:#fff!important;background:#2bb5fd}.apply-sure-container[data-v-6ea52adc]  uni-checkbox .uni-checkbox-input{width:15px;height:15px}.apply-sure-container[data-v-6ea52adc]  uni-checkbox .uni-checkbox-input.uni-checkbox-input-checked:before{font-size:18px}.apply-sure-container[data-v-6ea52adc]  .uni-date-x{opacity:0}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item--isDay, .apply-sure-container[data-v-6ea52adc]  .uni-calendar-item--checked{background:none;opacity:1}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item__weeks-lunar-text{display:none}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item__weeks-box-item{border-radius:5px;background-color:#2bb5fd;margin-bottom:10px;width:45px;height:45px}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item__weeks-box-item .uni-calendar-item__weeks-box-circle{display:none}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item__weeks-box-item .uni-calendar-item__weeks-box-text{color:#fff}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item__weeks-box-item .uni-calendar-item--isDay-text{color:#fff}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item__weeks-box-item .uni-calendar-item--isDay-text::after{content:"";width:10px;height:3px;background:#fff;position:absolute;left:50%;-webkit-transform:translate(-50%);transform:translate(-50%);bottom:10px}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item--disable .uni-calendar-item__weeks-box-item{background-color:hsla(0,0%,97.6%,.3)}.apply-sure-container[data-v-6ea52adc]  .uni-calendar-item--disable .uni-calendar-item__weeks-box-item .uni-calendar-item__weeks-box-text{color:silver}.apply-sure-container .time-container[data-v-6ea52adc]{padding:20px;background:#fff;height:430px}.apply-sure-container .time-container .time-item uni-view[data-v-6ea52adc]{border-radius:8px;padding:10px 5px;margin-bottom:10px;font-size:16px;color:#fff;text-align:center;background:#2bb5fd}.apply-sure-container .order-success-container[data-v-6ea52adc]{background:url('+o+") #fff no-repeat 0 0;background-size:100%;border-radius:24px;text-align:center;padding:130px 0 5px;box-sizing:border-box;width:100%;margin:0 auto}.apply-sure-container .order-success-container .success-icon[data-v-6ea52adc]{width:50px;height:50px;border-radius:50%;background:#2bb5fd;display:flex;justify-content:center;align-items:center;margin:0 auto 20px}.apply-sure-container .order-success-container .success-icon[data-v-6ea52adc]  .uni-icons{color:#fff!important}.apply-sure-container .order-success-container .info-title[data-v-6ea52adc]{font-size:14px;font-weight:700;margin-bottom:10px}.apply-sure-container .order-success-container .sub-title[data-v-6ea52adc]{font-size:12px;color:#999;text-align:left;width:85%;margin:0 auto 15px}.apply-sure-container .order-success-container uni-button[data-v-6ea52adc]{margin:5px 0;border-radius:15px}.apply-sure-container .order-success-container uni-button[type=primary][plain][data-v-6ea52adc]{border:none}.apply-sure-container[data-v-6ea52adc]  .uni-calendar__box{padding:20px}.apply-sure-container[data-v-6ea52adc]  .uni-calendar__content{border-radius:10px 10px 0 0!important}.apply-sure-container .uni-popup[data-v-6ea52adc]  .uni-navbar__content{border-radius:10px 10px 0 0!important}.apply-sure-container .uni-popup[data-v-6ea52adc]  .uni-navbar__header{border-radius:10px 10px 0 0!important}.apply-sure-container .uni-popup .uni-navbar[data-v-6ea52adc]{border-radius:10px 10px 0 0!important}.apply-sure-container .uni-popup[data-v-6ea52adc]  .uni-popup__wrapper{border-radius:10px 10px 0 0!important}.apply-sure-container .uni-popup[data-v-6ea52adc]  uni-view[name=content]{bottom:0!important;bottom:constant(safe-area-inset-bottom)!important;bottom:-env(safe-area-inset-bottom)!important;border-radius:10px!important}.apply-sure-container .orderSuccessPopup[data-v-6ea52adc]  .uni-popup__wrapper{border-radius:25px 25px 0 0!important}",""]),e.exports=t},"6ac5":function(e,t,a){"use strict";a.r(t);var n=a("7661"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=r.a},7661:function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf"),a("ac1f"),a("5319"),a("1276"),a("4de4"),a("d3b7"),a("e9c4");var r=n(a("1da1")),i=n(a("53ca")),o=a("0de7"),c=a("b970");function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e||(e=new Date),"object"!==(0,i.default)(e)&&(e=e.replace(/-/g,"/"));var a=new Date(e);a.setDate(a.getDate()+t);var n=a.getFullYear(),r=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,o=a.getDate()<10?"0"+a.getDate():a.getDate();return{fullDate:n+"-"+r+"-"+o,year:n,month:r,date:o,day:a.getDay()}}var u={data:function(){return{crApplyItemList:[],personInfo:{},infoList:[],currentDate:"",info:{lunar:!0,range:!0,insert:!1,selected:[]},startDate:s(new Date,0).fullDate,endDate:s(new Date,6).fullDate,defaultDate:s(new Date,0).fullDate,timeList:[],avaFirst:{},currentTime:"",periodText:"",continueFlag:!1,dayLimit:30,avaTime:{},tempDate:"",orderData:{},residue:!0,propVal:"",timeSurplus:[],appBooking:sessionStorage.getItem("c_app_booking")}},onLoad:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.query){a.next=5;break}n=JSON.parse(e.query.item),t.personInfo=n,a.next=7;break;case 5:return a.next=7,t.getPersonInfo();case 7:t.getInfoList();case 8:case"end":return a.stop()}}),a)})))()},methods:{checkboxChange:function(e){console.log(e.detail.value),this.crApplyItemList=e.detail.value},back:function(){this.$router.go(-1)},getPersonInfo:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,n,r,i,c,s,u,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={hospitalTag:localStorage.getItem("c_hospitalTag")},t.next=3,(0,o.getPatientList)(a);case 3:if(n=t.sent,0==n.code&&n.data.length>0){if(r=localStorage.getItem("c_defaultPatientId"),i=0,null!=r&&void 0!=r)for(c=0;c<n.data.length;c++)r==n.data[c].patientId&&(i=c);if(e.personInfo=n.data[i],void 0!=e.personInfo.cards&&null!=e.personInfo.cards&&e.personInfo.cards.length>0){for(s=0;s<e.personInfo.cards.length;s++)e.personInfo.cards[s].cardTypeT=e.cardTypeTrans(e.personInfo.cards[s].cardType);for(u=[],p=0;p<e.personInfo.cards.length;p++)""!=e.personInfo.cards[p].cardTypeT&&u.push(e.personInfo.cards[p]);e.personInfo.cards=u}localStorage.setItem("c_defaultPatientId",n.data[i].patientId)}case 5:case"end":return t.stop()}}),t)})))()},ifCanSelect:function(e){return!!e.overdue},getInfoList:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={cards:e.personInfo.cards,status:[1],current:"0",size:"9999999999"},t.next=3,(0,o.patientAll)(a);case 3:if(n=t.sent,0==n.code)for(e.infoList=n.data.records,e.crApplyItemList=[],r=0;r<e.infoList.length;r++)e.infoList[r]["checked"]=!0,e.infoList[r].overdue||e.crApplyItemList.push(e.infoList[r].applyItemId);case 5:case"end":return t.stop()}}),t)})))()},openCalendar:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,n,r,i,c,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=e.crApplyItemList.length){t.next=3;break}return uni.showModal({title:"提示",content:"请先预约项目！",showCancel:!1}),t.abrupt("return",!1);case 3:return a={crApplyItemIds:e.crApplyItemList},t.next=6,(0,o.checkAvaData)(a);case 6:if(n=t.sent,0==n.code)if(r=n.data.busObj,e.crApplyItemList.length==r.length)e.avaFirstData();else{for(i="",e.crApplyItemList=[],c=0;c<r.length;c++)for(s=0;s<e.infoList.length;s++)r[c].id==e.infoList[s].applyItemId&&(i+=". "+(c+1)+"、 "+e.infoList[s].itemName+"\n",e.crApplyItemList.push(r[c].id));u="仅以下检查项目可以一起预约，是否继续？\n"+i+"\n_____________________________\n其余检查项目可另行预约",""!=i&&uni.showModal({title:"提示",content:u,success:function(t){t.confirm&&e.avaFirstData()}})}case 8:case"end":return t.stop()}}),t)})))()},avaFirstData:function(){var e=this;this.$refs.calendar.open(),setTimeout((0,r.default)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.avaFirst["crApplyItemList"]=e.crApplyItemList,e.periodText="",a=e.startDate,t.next=5,(0,o.getOpenDay)(e.avaFirst);case 5:if(n=t.sent,0!=n.code){t.next=15;break}if(void 0!=n.data.obj&&null!=n.data.obj?(e.dayLimit=n.data.obj.openDay,e.endDate=s(new Date,e.dayLimit-1).fullDate):(e.dayLimit=e.$options.data().dayLimit,e.endDate=s(new Date,e.dayLimit-1).fullDate),e,t.t0=a,!t.t0){t.next=13;break}return t.next=13,e.handleDate(a).then((function(){}));case 13:t.next=17;break;case 15:return uni.showModal({title:"提示",content:n.msg,showCancel:!1}),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t)}))))},handleDate:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=[],n=e.split(","),t.tempDate=n[0].replace(/-/g,"/").replace(/\/0(\d)/g,"/$1"),t.defaultDate=s(t.tempDate,0).fullDate,console.log(t.tempDate,"tempDate"),r={},r["date"]=t.tempDate,a.next=9,t.handleDayChanged(r);case 9:case"end":return a.stop()}}),a)})))()},handleDayChanged:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var n,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(n=e.date.split("/"),r=0;r<n.length;r++)n[r]<10&&(n[r]="0"+n[r]);return i=n.join("-"),t.avaTime["crApplyItemList"]=t.crApplyItemList,t.avaTime["date"]=i,a.next=7,t.avaTimeMask(t.avaTime);case 7:case"end":return a.stop()}}),a)})))()},avaTimeMask:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var n,r,i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,o.avaTime)(e);case 2:if(n=a.sent,0!=n.code){a.next=13;break}r=n.data.busObj,i=n.msg,c=n.data.obj,t.orderData["date"]=t.avaTime["date"],"number"==i&&r?(t.propVal=i,t.residue=!0,r=r.filter((function(e){return e.ava>0}))):(t.residue=!1,t.propVal=""),t.timeSurplus=r,c&&"string"==typeof c&&uni.showModal({title:"提示",content:c,showCancel:!1}),a.next=16;break;case 13:return uni.showModal({title:"提示",content:n.msg,showCancel:!1}),t.timeSurplus=[],a.abrupt("return",!1);case 16:case"end":return a.stop()}}),a)})))()},currentDateEvent:function(e){this.currentDate=e.fulldate;var t=this,a={};a["date"]=this.currentDate,this.handleDayChanged(a).then((function(){t.$refs.timePopup.open()}))},saveTime:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e.ava,i=e.num,t.periodText=e.text,t.propVal||!(t.orderData.length>n)){a.next=6;break}return uni.showModal({title:"提示",content:"患者预约的项目数量大于该诊室下接诊的数量",showCancel:!1}),a.abrupt("return",!1);case 6:uni.showModal({title:"提示",content:"确认预约("+t.currentDate+" "+e.text+")?",cancelText:"再想想",success:function(a){a.confirm&&setTimeout((0,r.default)(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.orderData["crApplyItemList"]=t.crApplyItemList,t.orderData["periodText"]=t.periodText,t.orderData["phone"]=t.personInfo.phone,t.orderData["sex"]=t.personInfo.sex,t.orderData["orderTime"]=t.currentDate+" "+e.text,t.orderData["period"]=i,c.Toast.loading({message:"提交中...",forbidClick:!0,duration:3e4}),a.next=9,(0,o.order)(t.orderData);case 9:if(n=a.sent,c.Toast.clear(),0!=n.code){a.next=19;break}return t.orderData["applyItems"]=t.crApplyItemList,a.next=15,(0,o.checkStatus)(t.orderData);case 15:r=a.sent,("rank"==n.msg&&0==r.code||0==r.code)&&(t.$refs.calendar.close(),t.$refs.timePopup.close(),t.$refs.orderSuccessPopup.open()),a.next=20;break;case 19:uni.showToast({title:n.msg,duration:2e3,icon:"none"});case 20:case"end":return a.stop()}}),a)}))))}});case 7:case"end":return a.stop()}}),a)})))()},seeOrderList:function(){uni.redirectTo({url:"/pages/orderList/orderList?data=".concat(encodeURIComponent(JSON.stringify(this.personInfo)))}),this.$refs.orderSuccessPopup.close()},cardTypeTrans:function(e){var t="";switch(e){case"PH0091_01":t="1";break;case"PH0091_11":t="2";break;case"PH0091_10":t="3";break}return t},backEvent:function(){uni.redirectTo({url:sessionStorage.getItem("c_previousRoutePath")})},closeEvent:function(){window.parent.postMessage({key:"close"},"*")},goToCheckApply:function(){uni.redirectTo({url:"/pages/checkApply/checkApply"})}}};t.default=u},"8ff2":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}));var n={uniCard:a("2570").default,uniPopup:a("7822").default,uniCalendar:a("25d4").default,uniNavBar:a("f28b").default,uniRow:a("3b90").default,uniCol:a("484a").default},r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"apply-sure-container public-container"},[a("van-nav-bar",{staticClass:"blueNavBar",attrs:{title:"预约确认","left-arrow":!0,fixed:!0,placeholder:!0,"safe-area-inset-top":!0},on:{"click-left":function(t){arguments[0]=t=e.$handleEvent(t),e.backEvent.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[a("van-icon",{attrs:{name:"cross",size:"18"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.closeEvent.apply(void 0,arguments)}}})]},proxy:!0}])}),a("v-uni-view",{staticClass:"person-contaner"},[a("v-uni-view",{staticClass:"left-content"},[a("v-uni-view",{staticClass:"black-text"},[e._v("当前就诊人："),a("v-uni-text",{staticClass:"primary-text"},[e._v(e._s(e.personInfo.name))])],1),a("v-uni-view",[e._v("性别："),a("v-uni-text",[e._v(e._s("0"==e.personInfo.sex?"男":"1"==e.personInfo.sex?"女":"未知"))])],1),a("v-uni-view",[e._v("证件号码："),a("v-uni-text",[e._v(e._s(e.personInfo.idCard||"--"))])],1)],1)],1),a("v-uni-view",{staticClass:"main-container"},[a("v-uni-checkbox-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.checkboxChange.apply(void 0,arguments)}}},e._l(e.infoList,(function(t,n){return a("uni-card",{key:n,attrs:{title:t.itemName,extra:"未预约"}},[a("v-uni-checkbox",{staticClass:"my-check-box",attrs:{value:t.applyItemId,checked:e.crApplyItemList.includes(t.applyItemId),disabled:e.ifCanSelect(t)}}),a("v-uni-view",{staticClass:"card-list"},[a("v-uni-text",{staticClass:"apply-key"},[e._v("申请单号：")]),e._v(e._s(t.applyNo))],1),a("v-uni-view",{staticClass:"card-list"},[a("v-uni-text",{staticClass:"apply-key"},[e._v("申请科室：")]),e._v(e._s(t.deptName))],1),a("v-uni-view",{staticClass:"card-list"},[a("v-uni-text",{staticClass:"apply-key"},[e._v("就诊医院：")]),e._v(e._s(t.orgName))],1)],1)})),1),a("v-uni-view",{staticClass:"btn-container"},[1==e.appBooking?a("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openCalendar.apply(void 0,arguments)}}},[e._v("确认预约")]):e._e()],1)],1),a("uni-popup",{ref:"calendar",attrs:{type:"bottom","safe-area":!1,"background-color":"#fff"}},[a("uni-calendar",{ref:"calendar",attrs:{"start-date":e.startDate,"end-date":e.endDate,date:e.defaultDate,selected:e.info.selected},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.currentDateEvent.apply(void 0,arguments)}}})],1),a("uni-popup",{ref:"timePopup",attrs:{type:"bottom","safe-area":!1,"background-color":"#fff"}},[a("uni-nav-bar",{attrs:{shadow:!0,"left-icon":"left","right-icon":"closeempty",title:e.currentDate},on:{clickLeft:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.timePopup.close()},clickRight:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.timePopup.close()}}}),a("uni-row",{staticClass:"time-container",attrs:{gutter:30}},e._l(e.timeSurplus,(function(t,n){return a("uni-col",{key:n,staticClass:"time-item",attrs:{span:12,"data-index":n}},[a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.ava>0,expression:"item.ava > 0"}],on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.saveTime(t)}}},[e._v(e._s(t.text))])],1)})),1)],1),a("uni-popup",{ref:"orderSuccessPopup",staticClass:"orderSuccessPopup",attrs:{type:"center","is-mask-click":!1,"safe-area":!1,"background-color":"#fff"}},[a("v-uni-view",{staticClass:"order-success-container"},[a("v-uni-view",{staticClass:"info-title"},[e._v("预约提交成功")]),a("v-uni-view",{staticClass:"sub-title"},[e._v("请您根据检查预约时间（建议提前20分钟）前往。")]),a("v-uni-view",[a("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.goToCheckApply.apply(void 0,arguments)}}},[a("v-uni-button",{attrs:{type:"primary",size:"mini"}},[e._v("返回首页")])],1)],1),a("v-uni-view",[a("v-uni-button",{attrs:{type:"primary",size:"mini",plain:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.seeOrderList.apply(void 0,arguments)}}},[e._v("查看订单")])],1)],1)],1)],1)},i=[]},c2c3:function(e,t,a){"use strict";a.r(t);var n=a("8ff2"),r=a("6ac5");for(var i in r)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(i);a("e67b");var o,c=a("f0c5"),s=Object(c["a"])(r["default"],n["b"],n["c"],!1,null,"6ea52adc",null,!1,n["a"],o);t["default"]=s.exports},d01a:function(e,t,a){var n=a("3dfa");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("4f06").default;r("76f5aa1e",n,!0,{sourceMap:!1,shadowMode:!1})},e67b:function(e,t,a){"use strict";var n=a("d01a"),r=a.n(n);r.a}}]);