(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["root"],{"0996":function(e,t,r){},"1ee0":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"preview-container"},[e.projectConfig.projectKey?r("el-tabs",{attrs:{type:"card"}},[r("el-tab-pane",[r("span",{attrs:{slot:"label"},slot:"label"},[r("i",{staticClass:"el-icon-mobile"}),e._v(" 手机 ")]),r("div",{staticClass:"preview-layer"},[r("div",{staticClass:"preview-bg"}),r("div",{staticClass:"preview-phone"},[r("iframe",{staticClass:"preview-html",attrs:{id:"preview-html",scrolling:"auto",name:"preview-html",frameborder:"0",src:e.mobilePreviewUrl}})])])]),r("el-tab-pane",[r("span",{attrs:{slot:"label"},slot:"label"},[r("i",{staticClass:"el-icon-monitor"}),e._v(" 电脑 ")]),r("el-scrollbar",{staticStyle:{height:"77vh"}},[e.projectConfig.projectKey?r("project-form",{attrs:{projectConfig:e.projectConfig}}):e._e()],1)],1)],1):e._e()],1)},n=[],i=(r("99af"),r("f18e")),c={name:"PreView",props:{projectKey:""},data:function(){return{mobilePreviewUrl:"",projectConfig:{projectKey:"",showBtns:!0}}},mounted:function(){var e=window.location.protocol+"//"+window.location.host;this.mobilePreviewUrl="".concat(e,"/project/view?key=").concat(this.projectKey),this.$set(this.projectConfig,"projectKey",this.projectKey)},components:{ProjectForm:i["default"]}},a=c,s=(r("6db6"),r("2877")),u=Object(s["a"])(a,o,n,!1,null,"16ec27ca",null);t["default"]=u.exports},"25c3":function(e,t,r){},"44e77":function(e,t,r){r("fb6a");var o,n,i=r("2b80"),c=window.requestAnimationFrame,a=window.cancelAnimationFrame,s=36e4,u=function(){var e;function t(){var r=new Date,i=r-o;i,n+=i,o=r,e=n<=s?c(t):null,document.getElementById("inActiveTime").innerText=n}return{start:function(){e||(o=new Date,e=c(t))},stop:function(){e&&(a(e),e=null)}}}();function l(){u.start()}function p(){u.stop()}"onfocusin"in document?(document.onfocusin=l,document.onfocusout=p):(window.onfocus=l,window.onblur=p);var m,f,d,h=["","webkit","moz","ms","o"];if(g){for(var j=0;j<h.length;j++)if(m=h[j],f=m?m+"Hidden":"hidden",f in document){d=m+"visibilitychange";break}d&&_(document,d,(function(){document[f]?p():l()}))}function g(){var e=i(navigator.userAgent);if(e.device){var t=e.device.type;if(t&&"mobile"==t)return!0}return!1}function _(e,t,r){e.addEventListener?("on"===t.slice(0,2)&&(t=t.slice(2)),e.addEventListener(t,r)):e.attachEvent?("on"!==t.slice(0,2)&&(t="on"+t),e.attachEvent(t,r)):"on"!==t.slice(0,2)?e["on"+t]=r:e[t]=r}n=0,u.start()},"46a8":function(e,t,r){"use strict";r.d(t,"l",(function(){return n})),r.d(t,"h",(function(){return i})),r.d(t,"n",(function(){return c})),r.d(t,"j",(function(){return a})),r.d(t,"k",(function(){return s})),r.d(t,"i",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"r",(function(){return p})),r.d(t,"v",(function(){return m})),r.d(t,"u",(function(){return f})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h})),r.d(t,"q",(function(){return j})),r.d(t,"y",(function(){return g})),r.d(t,"z",(function(){return _})),r.d(t,"e",(function(){return b})),r.d(t,"c",(function(){return w})),r.d(t,"p",(function(){return v})),r.d(t,"x",(function(){return y})),r.d(t,"o",(function(){return x})),r.d(t,"t",(function(){return C})),r.d(t,"w",(function(){return S})),r.d(t,"s",(function(){return T})),r.d(t,"f",(function(){return O})),r.d(t,"m",(function(){return P})),r.d(t,"g",(function(){return I}));var o=r("b775");function n(e){return Object(o["a"])({url:"/user/project/list",method:"get",params:e})}function i(e){return Object(o["a"])({url:"/user/project/report/stats",method:"get",params:e})}function c(e){return Object(o["a"])({url:"/user/project/report/situation",method:"get",params:e})}function a(e){return Object(o["a"])({url:"/user/project/report/position",method:"get",params:e})}function s(e){return Object(o["a"])({url:"/user/project/report/source",method:"get",params:e})}function u(e){return Object(o["a"])({url:"/user/project/report/device",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/user/project/delete",method:"get",params:e})}function p(e){return Object(o["a"])({url:"/user/project/page",method:"get",params:e})}function m(e){return Object(o["a"])({url:"/project/template/type/list",method:"get",params:e})}function f(e){return Object(o["a"])({url:"/project/template/page",method:"get",params:e})}function d(e){return Object(o["a"])({url:"/user/project/create",method:"post",data:e})}function h(e){return Object(o["a"])({url:"/user/project/template/create/",method:"post",data:e})}function j(e){return Object(o["a"])({url:"/user/project/item/max-form-id",method:"get",params:e})}function g(e){return Object(o["a"])({url:"/user/project/update",method:"post",data:e})}function _(e){return Object(o["a"])({url:"/user/project/item/update",method:"post",data:e})}function b(e){return Object(o["a"])({url:"/user/project/item/delete",method:"post",data:e})}function w(e){return Object(o["a"])({url:"/user/project/item/create",method:"post",data:e})}function v(e){return Object(o["a"])({url:"/user/project/item/list",method:"get",params:e})}function y(e){return Object(o["a"])({url:"/user/project/item/sort",method:"post",data:e})}function x(e){return Object(o["a"])({url:"/user/project/publish",method:"post",data:e})}function C(e){var t="/user/project/setting/"+e;return Object(o["a"])({url:t,method:"get"})}function S(e){return Object(o["a"])({url:"/user/project/setting/save",method:"post",data:e})}function T(e){return Object(o["a"])({url:"/user/project/result/page",method:"get",params:e})}function O(e){return Object(o["a"])({url:"/user/project/result/export",method:"get",responseType:"blob",params:e})}function P(e,t){return Object(o["a"])({url:e,method:"post",data:t})}function I(e,t){return Object(o["a"])({url:e,method:"get",params:t})}},"5c9f":function(e,t,r){},"6db6":function(e,t,r){"use strict";r("25c3")},7260:function(e,t,r){"use strict";r("5c9f")},9977:function(e,t,r){var o={"./el-button.js":"aace","./el-checkbox-group.js":"9413","./el-input.js":"167d","./el-radio-group.js":"2cfa","./el-select.js":"7f29","./el-upload.js":"0f88"};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=i,e.exports=n,n.id="9977"},ac96:function(e,t,r){"use strict";r("0996")},bcc2:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return s}));r("d3b7"),r("159b"),r("b64b"),r("4ec9"),r("3ca3"),r("ddb0"),r("99af"),r("4e82");var o=r("2ef0"),n=r.n(o),i=r("7ce6");r("ed08");function c(e,t){var r={type:e.typeId,formItemId:e.__config__.formId,label:e.__config__.label,defaultValue:e.__config__.defaultValue,required:e.__config__.required,summation:e.__config__.summation,placeholder:e.placeholder,regList:e.__config__.regList,showLabel:e.__config__.showLabel,span:e.__config__.span,formItemName:e.__vModel__,jsonItemName:e.__config__.jsonItemName,projectKey:t},o={},i=u[e.typeId];return i&&(Object.keys(i).forEach((function(t){var r=n.a.get(e,i[t]);n.a.set(o,t,r)})),n.a.set(r,"expand",o)),r}var a=new Map;function s(e){var t=e.required,r=e.placeholder;t&&!r&&(e.placeholder="此题为必填项目"),!a.size>0&&n.a.concat(i["b"],i["c"]).forEach((function(e){a.set(e.typeId,e)}));var o=a.get(e.type),c=n.a.cloneDeep(o),s=u[e.type];return s&&Object.keys(s).forEach((function(t){var r=n.a.get(e.expand,t);n.a.set(c,s[t],r)})),c.sort=e.sort,c.typeId=e.type,c.__config__.span=e.span,c.__config__.formId=e.formItemId,c.__config__.label=e.label,c.__config__.required=e.required,c.__config__.regList=e.regList,c.__config__.showLabel=e.showLabel,c.__config__.jsonItemName=e.jsonItemName,e.defaultValue&&(e.defaultValue.json?c.__config__.defaultValue=JSON.parse(e.defaultValue.value):c.__config__.defaultValue=e.defaultValue.value),"el-upload"===c.__config__.tag&&(c.action=c.action+e.projectKey),c.regList=e.regList,c.placeholder=e.placeholder,c.__vModel__=e.formItemName,c}var u={1:{prepend:"__slot__.prepend",maxlength:"maxlength",append:"__slot__.append"},2:{minRows:"autosize.minRows",maxRows:"autosize.maxRows",maxlength:"maxlength"},4:{min:"min",max:"max",maxlength:"maxlength",step:"step","step-strictly":"step-strictly",precision:"precision","controls-position":"controls-position"},5:{options:"__slot__.options",filterable:"filterable",multiple:"multiple"},6:{options:"options",filterable:"filterable",multiple:"props.props.multiple"},7:{options:"__slot__.options",filterable:"filterable",multiple:"props.props.multiple"},8:{optionType:"__config__.optionType",size:"size",options:"__slot__.options",max:"max",min:"min"},9:{},10:{min:"min",max:"max",step:"step"},11:{},13:{dateType:"dateType",format:"format"},15:{max:"max"},17:{buttonText:"__config__.buttonText",showTip:"__config__.showTip",fileSize:"__config__.fileSize",sizeUnit:"__config__.sizeUnit",listType:"list-type",limit:"limit",multiple:"multiple"}}},f18e:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"project-form",style:{backgroundColor:e.projectTheme.backgroundColor,background:e.projectTheme.backgroundImg?"url("+e.projectTheme.backgroundImg+")  no-repeat center":""}},[r("div",{},[r("div",{style:{textAlign:e.projectTheme.logoPosition}},[r("img",{staticClass:"logo-img",attrs:{src:e.projectTheme.logoImg}})]),e.projectTheme.headImgUrl?r("el-image",{staticStyle:{width:"100%"},attrs:{src:e.projectTheme.headImgUrl,fit:"scale-down"}}):e._e(),e.projectTheme.showTitle?r("h4",{staticClass:"form-name-text",staticStyle:{"text-align":"center"}},[e._v(" "+e._s(e.formConf.title)+" ")]):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:e.projectTheme.showDescribe,expression:"projectTheme.showDescribe"}],staticClass:"form-name-text",domProps:{innerHTML:e._s(e.formConf.description)}}),r("el-divider"),e.startParser?r("parser",{attrs:{"form-conf":e.formConf},on:{submit:e.submitForm}}):e._e()],1)])},n=[],i=(r("d81d"),r("b0c0"),r("a4d3"),r("e01a"),r("9f75")),c=r("bcc2"),a=r("46a8");window.onload=function(){document.addEventListener("touchstart",(function(e){e.touches.length>1&&e.preventDefault()})),document.addEventListener("gesturestart",(function(e){e.preventDefault()}))};var s={components:{Parser:i["a"]},props:{projectConfig:{projectKey:"",showBtns:!0,projectKind:1}},data:function(){return{startParser:!1,projectTheme:{headImgUrl:"",logoImg:"",showTitle:!0,showDescribe:!0},formConf:{fields:[],projectKey:"",projectKind:1,__methods__:{},formRef:"elForm",formModel:"formData",labelFormModel:"labelFormData",size:"small",labelPosition:"top",labelWidth:100,formRules:"rules",gutter:15,disabled:!1,span:24,formBtns:!0,resetBtn:!1,submitBtnText:"提交",submitBtnColor:"#205bb5",showNumber:!1,unFocusedComponentBorder:!0}}},computed:{},watch:{},beforeCreate:function(){document.querySelector("body").className="project-body"},created:function(){this.projectConfig&&this.projectConfig.projectKey?(this.formConf.projectKey=this.projectConfig.projectKey,this.projectConfig.projectKind&&(this.formConf.projectKind=this.projectConfig.projectKind)):this.$route.query.key&&(this.formConf.projectKey=this.$route.query.key,this.$route.query.kind&&(this.formConf.projectKind=this.$route.query.kind),this.formConf.formBtns=!0),this.formConf.size=window.innerWidth<480?"medium":"small"},mounted:function(){var e=this,t="/user/project/details/".concat(this.formConf.projectKey);2==this.formConf.projectKind&&(t="/project/template/details/".concat(this.formConf.projectKey)),Object(a["g"])(t).then((function(t){if(t.data){var r=1,o=t.data.projectItems.map((function(e){var t=Object(c["a"])(e);return t.serialNumber=r,r++,t}));if(e.formConf.fields=o,e.formConf.title=t.data.project.name,e.formConf.description=t.data.project.describe,e.formConf.description=t.data.project.describe,t.data.userProjectTheme){e.projectTheme=t.data.userProjectTheme;var n=t.data.userProjectTheme,i=n.submitBtnText,a=n.showNumber,s=n.btnsColor;i&&(e.formConf.submitBtnText=i),a&&(e.formConf.showNumber=a),s&&(e.formConf.submitBtnColor=s)}e.startParser=!0}}))},methods:{submitForm:function(e){this.$emit("submit",e)}}},u=s,l=(r("7260"),r("2877")),p=Object(l["a"])(u,o,n,!1,null,null,null);t["default"]=p.exports},f5dfd:function(e,t,r){"use strict";r.r(t);var o,n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"write-container"},[r("h1",{staticStyle:{display:"none"},attrs:{id:"inActiveTime"}}),0==e.writeStatus?r("div",{staticClass:"title-icon-view"},[e._m(0),e.writeNotStartPrompt?r("p",{staticStyle:{"text-align":"center"}},[e.writeNotStartPrompt?r("span",[e._v(e._s(e.writeNotStartPrompt))]):e._e()]):e._e()]):e._e(),1==e.writeStatus?r("div",[e.projectConfig.projectKey?r("project-form",{attrs:{projectConfig:e.projectConfig},on:{submit:e.submitForm}}):e._e()],1):e._e(),2==e.writeStatus?r("div",{staticClass:"title-icon-view"},[r("p",{staticStyle:{"text-align":"center"}},[e.allscore?r("span",[e._v(e._s(e.allscore))]):e._e()]),e._m(1),r("p",{staticStyle:{"text-align":"center"}},[e.userProjectSetting.submitPromptText?r("span",[e._v(e._s(e.userProjectSetting.submitPromptText))]):r("span",[e._v(e._s(e.globalDefaultValue.projectSubmitPromptText))])]),r("div",[e.userProjectSetting.submitPromptImg?r("el-image",{attrs:{src:e.userProjectSetting.submitPromptImg,fit:"cover"}}):e._e()],1)]):e._e()])},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"icon-view"},[r("i",{staticClass:"el-icon-check success-icon"})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"icon-view"},[r("i",{staticClass:"el-icon-check success-icon"})])}],c=(r("b0c0"),r("2ca0"),r("f18e")),a=r("c88b"),s=r("5c96"),u=r.n(s);function l(e){if(o)e(o);else{var t=u.a.Loading.service({fullscreen:!0,lock:!0,text:"wxsdk资源加载中...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.5)"});Object(a["a"])("https://res.wx.qq.com/open/js/jweixin-1.6.0.js",(function(){t.close(),o=wx,e(o)}))}}var p={projectShareTitle:"填鸭表单",projectShareDesc:"快来填写吧",projectShareImg:"https://qiniu.smileyi.top/c4ca4238a0b923820dcc509a6f75849b/4b2c7071f3f543549907b9e3b41df1ed.png",projectSubmitPromptText:"您已完成本次填写，感谢您的帮助与支持"},m=r("ed08"),f=r("46a8"),d=r("2b80"),h=d(navigator.userAgent);r("44e77");var j={name:"WriteView",props:{},data:function(){return{inActiveTime:0,projectConfig:{projectKey:"",preview:!1,showBtns:!0},writeStatus:1,writeNotStartPrompt:"",allscore:"",userProjectSetting:{submitPromptText:""},globalDefaultValue:p,wxAuthorizationUrl:"",wxAuthorizationCode:"",wxUserInfo:{},wxSignature:{}}},beforeCreate:function(){var e=document.createElement("meta");e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",e.name="viewport",document.getElementsByTagName("head")[0].appendChild(e)},created:function(){var e=this.$route.query.key;this.projectConfig.projectKey=e;var t=Object(m["h"])("code");t&&(this.wxAuthorizationCode=t,this.getWxAuthorizationUserInfo()),this.getWxAuthorizationUrl(),this.queryProjectSettingStatus(),this.queryProjectSetting()},mounted:function(){this.viewProjectHandle()},components:{ProjectForm:c["default"]},methods:{viewProjectHandle:function(){Object(f["m"])("/user/project/result/view/".concat(this.projectConfig.projectKey),{params:{projectKey:this.projectConfig.projectKey}}).then((function(e){}))},queryProjectSettingStatus:function(){var e=this;Object(f["g"])("/user/project/setting-status",{projectKey:this.projectConfig.projectKey}).then((function(t){t.msg&&(e.writeNotStartPrompt=t.msg,e.writeStatus=0)}))},getWxAuthorizationUserInfo:function(){this.wxAuthorizationCode},getWxAuthorizationUrl:function(){},setWxConfig:function(){var e=this,t=this.wxSignature;l((function(r){r.config({debug:!1,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["updateAppMessageShareData","updateTimelineShareData","onMenuShareAppMessage","onMenuShareTimeline","showMenuItems","hideMenuItems","chooseWXPay"]}),r.ready((function(){console.log("ready"),e.setWxProjectShare(r)}))}))},setWxProjectShare:function(e){var t=this.userProjectSetting,r=t.shareImg,o=t.shareTitle,n=t.shareDesc;e.updateAppMessageShareData({title:o||p.projectShareTitle,desc:n||p.projectShareDesc,link:window.location.href,imgUrl:r||p.projectShareImg,success:function(){console.log("succcess")},fail:function(){console.log("fail")}}),e.updateTimelineShareData({title:o||p.projectShareTitle,desc:n||p.projectShareDesc,link:window.location.href,imgUrl:r||p.projectShareImg,success:function(){console.log("succcess")},fail:function(){console.log("fail")}}),e.onMenuShareTimeline({title:o||p.projectShareTitle,desc:n||p.projectShareDesc,link:window.location.href,imgUrl:r||p.projectShareImg,success:function(){console.log("succcess")}}),e.onMenuShareAppMessage({title:o||p.projectShareTitle,desc:n||p.projectShareDesc,link:window.location.href,imgUrl:r||p.projectShareImg,success:function(){console.log("succcess")}})},queryProjectSetting:function(){var e=this;Object(f["g"])("/user/project/setting/${this.projectConfig.projectKey}",null).then((function(t){t.data&&(e.userProjectSetting=t.data,t.data&&t.data.wxWrite&&(t.data.recordWxUser&&!e.wxAuthorizationCode?location.href=e.wxAuthorizationUrl:e.onlyWxOpenHandle()))}))},onlyWxOpenHandle:function(){var e=navigator.userAgent.toLowerCase(),t=-1!=e.indexOf("micromessenger");t||(document.head.innerHTML='<title>抱歉，出错了</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><link rel="stylesheet" type="text/css" href="https://res.wx.qq.com/open/libs/weui/0.4.1/weui.css">',document.body.innerHTML='<div class="weui_msg"><div class="weui_icon_area"><i class="weui_icon_info weui_icon_msg"></i></div><div class="weui_text_area"><h4 class="weui_msg_title">请在微信客户端打开链接</h4></div></div>')},submitForm:function(e){var t=this,r=document.getElementById("inActiveTime").innerText;Object(f["m"])("/user/project/result/create",{completeTime:r,projectKey:this.projectConfig.projectKey,submitOs:h.os.name,submitBrowser:h.browser.name,submitUa:h,patientId:this.$route.query.patientId,originalData:e.formModel,processData:e.labelFormModel,submitJumpUrl:this.userProjectSetting.submitJumpUrl,jumpUrl:this.userProjectSetting.jumpUrl}).then((function(e){var r=t.userProjectSetting.submitJumpUrl;e.data&&(t.allscore="您本次提交的分数为"+e.data.itemScore+"分"),t.userProjectSetting.jumpUrl&&r&&(r.startsWith("http")&&r.startsWith("http")||(r="http://"+r),window.location.href=r),t.writeStatus=2}))}}},g=j,_=(r("ac96"),r("2877")),b=Object(_["a"])(g,n,i,!1,null,"1c481860",null);t["default"]=b.exports}}]);